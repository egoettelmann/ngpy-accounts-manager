<div class="login-wrapper">
  <form *ngIf="loginForm"
        class="login"
        autocomplete="off"
        [formGroup]="loginForm"
        (ngSubmit)="tryLogin()">
    <div class="title">
      <h3 class="welcome">{{ 'i18n.views.login.welcome.text' | translate }}</h3>
      <div>{{ 'i18n.app.title' | translate }}</div>
      <h5 class="hint">{{ 'i18n.views.login.help-text' | translate }}</h5>
    </div>
    <div class="login-group">
      <div [hidden]="formIsLoading">
        <input [formControlName]="'username'"
               autocomplete="off"
               clrInput
               name="username"
               class="username"
               type="text"
               id="login_username"
               [placeholder]="'i18n.views.login.form.placeholder.username' | translate">
        <input [formControlName]="'password'"
               autocomplete="off"
               clrInput
               name="password"
               class="password"
               type="password"
               id="login_password"
               [placeholder]="'i18n.views.login.form.placeholder.password' | translate">
        <clr-alert *ngIf="loginForm.errors"
                   [clrAlertType]="'danger'"
                   [clrAlertClosable]="false">
          <clr-alert-item *ngFor="let error of formErrors">
            <span class="alert-text"
                  [innerHTML]="'i18n.error.' + error | translate">
            </span>
          </clr-alert-item>
        </clr-alert>
      </div>
      <div class="spinner spinner-sm"
           [hidden]="!formIsLoading">
        <span>{{ 'i18n.views.login.loading' | translate }}</span>
      </div>
      <button type="submit"
              class="btn btn-primary"
              [disabled]="loginForm.invalid"
              [hidden]="formIsLoading">
        <span>{{ 'i18n.views.login.form.button.submit' | translate }}</span>
      </button>
    </div>
    <div class="login-footer">
      <div *ngIf="appProperties && appProperties.appVersion" class="login-footer__version">
        <span>{{ appProperties.appVersion }}</span>
      </div>
      <div *ngIf="apiStatus && apiStatus.progress === undefined" class="login-footer__status">
        <clr-icon *ngIf="!apiStatus.ready"
                  shape="exclamation-circle"
                  class="text-danger"
        ></clr-icon>
        <clr-icon *ngIf="apiStatus.ready"
                  shape="check-circle"
                  class="text-success"
        ></clr-icon>
      </div>
      <div *ngIf="apiStatus && apiStatus.progress !== undefined" class="login-footer__progress">
        <div class="progress top">
          <progress [value]="apiStatus.progress" max="100"></progress>
        </div>
      </div>
    </div>
  </form>
</div>

<app-notification-modal></app-notification-modal>
